angular.module("ng").config(["$provide",function(a){a.decorator("$browser",["$delegate","$window","$document","$log","$sniffer",function(a,b,c,d,e){function g(a,b){return f.call(a,b||0)}function h(a){var b=a.indexOf("#");return-1==b?a:a.substr(0,b)}function r(a){try{a.apply(null,g(arguments,1))}finally{if(p--,0===p)for(;q.length;)try{q.pop()()}catch(b){d.error(b)}}}function s(a){var b=a.indexOf("#");return-1===b?"":a.substr(b+1)}function v(a,b){!function c(){forEach(t,function(a){a()}),u=b(c,a)}()}function F(){H(),I()}function H(){w=b.history.state,w=angular.isUndefined(w)?null:w,angular.equals(w,G)&&(w=G),G=w}function I(){(y!==i.url()||x!==w)&&(y=i.url(),x=w,forEach(D,function(a){a(i.url(),w)}))}function M(a){try{return decodeURIComponent(a)}catch(b){return a}}console.log("iOS9 $browser patch applied");var f=[].slice,i=a,j=c[0],k=b.location,l=b.history,m=b.setTimeout,n=b.clearTimeout,o={};i.isMock=!1;var p=0,q=[];i.$$completeOutstandingRequest=r,i.$$incOutstandingRequestCount=function(){p++},i.notifyWhenNoOutstandingRequests=function(a){forEach(t,function(a){a()}),0===p?a():q.push(a)};var u,t=[];i.addPollFn=function(a){return angular.isUndefined(u)&&v(100,m),t.push(a),a};var w,x,y=k.href,z=c.find("base"),A=null,B=null,C=null;H(),x=w,i.url=function(a,c,d){if(angular.isUndefined(d)&&(d=null),k!==b.location&&(k=b.location),l!==b.history&&(l=b.history),!C&&B&&a&&(C=m(function(){k.href==B&&(B=null),C=null},0)),a){var f=x===d;if(y===a&&(!e.history||f))return i;var g=y&&h(y)===h(a);return y=a,x=d,!e.history||g&&f?(B=a,g||(A=a),c?k.replace(a):g?k.hash=s(a):k.href=a):(l[c?"replaceState":"pushState"](d,"",a),H(),x=w),i}var j=k.href.replace(/%27/g,"'");return B&&(j=B),k.href==B&&(B=null),A||j},i.state=function(){return w};var D=[],E=!1,G=null;i.onUrlChange=function(a){return E||(e.history&&angular.element(b).on("popstate",F),angular.element(b).on("hashchange",F),E=!0),D.push(a),a},i.$$checkUrlChange=I,i.baseHref=function(){var a=z.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var J={},K="",L=i.baseHref();return i.cookies=function(a,b){var c,e,f,g,h;if(!a){if(j.cookie!==K)for(K=j.cookie,e=K.split("; "),J={},g=0;g<e.length;g++)f=e[g],h=f.indexOf("="),h>0&&(a=M(f.substring(0,h)),void 0===J[a]&&(J[a]=M(f.substring(h+1))));return J}void 0===b?j.cookie=encodeURIComponent(a)+"=;path="+L+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(b)&&(c=(j.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+";path="+L).length+1,c>4096&&d.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+c+" > 4096 bytes)!"))},i.defer=function(a,b){var c;return p++,c=m(function(){delete o[c],r(a)},b||0),o[c]=!0,c},i.defer.cancel=function(a){return o[a]?(delete o[a],n(a),r(angular.noop),!0):!1},i}])}]);
